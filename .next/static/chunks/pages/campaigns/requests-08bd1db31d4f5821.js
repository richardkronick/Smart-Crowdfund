(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{19553:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/requests",function(){return n(9687)}])},5172:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(85893),a=(n(67294),n(80967));function s(){return(0,r.jsx)("div",{className:"row justify-content-md-center",style:{marginTop:"6rem",marginBottom:"2rem"},children:(0,r.jsx)(a.Z,{negative:!0,children:"Something went wrong. Most likely you are not connected to MetaMask, or you are not on the Rinkeby network. Please connect to Rinkeby via MetaMask and refresh the page."})})}},9687:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return re}});var r=n(34051),a=n.n(r),s=n(85893),o=n(67294),i=n(87462),l=n(13871),c=n(86010),u=n(98459),d=n(28935),p=n(12519),f=n(92248);function h(e){var t=e.children,n=e.className,r=(0,c.Z)(n),a=(0,d.Z)(h,e),s=(0,p.Z)(h,e);return o.createElement(s,(0,i.Z)({},a,{className:r}),t)}h.handledProps=["as","children","className"],h.defaultProps={as:"tbody"},h.propTypes={};var v=h,m=n(69591),g=n(45150);function b(e){var t=e.active,n=e.children,r=e.className,a=e.collapsing,s=e.content,l=e.disabled,h=e.error,v=e.icon,m=e.negative,y=e.positive,w=e.selectable,x=e.singleLine,j=e.textAlign,Z=e.verticalAlign,k=e.warning,P=e.width,R=(0,c.Z)((0,u.lG)(t,"active"),(0,u.lG)(a,"collapsing"),(0,u.lG)(l,"disabled"),(0,u.lG)(h,"error"),(0,u.lG)(m,"negative"),(0,u.lG)(y,"positive"),(0,u.lG)(w,"selectable"),(0,u.lG)(x,"single line"),(0,u.lG)(k,"warning"),(0,u.X4)(j),(0,u.Ok)(Z),(0,u.H0)(P,"wide"),r),C=(0,d.Z)(b,e),A=(0,p.Z)(b,e);return f.kK(n)?o.createElement(A,(0,i.Z)({},C,{className:R}),g.Z.create(v),s):o.createElement(A,(0,i.Z)({},C,{className:R}),n)}b.handledProps=["active","as","children","className","collapsing","content","disabled","error","icon","negative","positive","selectable","singleLine","textAlign","verticalAlign","warning","width"],b.defaultProps={as:"td"},b.propTypes={},b.create=(0,m.u5)(b,(function(e){return{content:e}}));var y=b;function w(e){var t=e.children,n=e.className,r=e.content,a=e.fullWidth,s=(0,c.Z)((0,u.lG)(a,"full-width"),n),l=(0,d.Z)(w,e),h=(0,p.Z)(w,e);return o.createElement(h,(0,i.Z)({},l,{className:s}),f.kK(t)?r:t)}w.handledProps=["as","children","className","content","fullWidth"],w.defaultProps={as:"thead"},w.propTypes={};var x=w;function j(e){var t=e.as,n=(0,d.Z)(j,e);return o.createElement(x,(0,i.Z)({},n,{as:t}))}j.handledProps=["as"],j.propTypes={},j.defaultProps={as:"tfoot"};var Z=j;function k(e){var t=e.as,n=e.className,r=e.sorted,a=(0,c.Z)((0,u.cD)(r,"sorted"),n),s=(0,d.Z)(k,e);return o.createElement(y,(0,i.Z)({},s,{as:t,className:a}))}k.handledProps=["as","className","sorted"],k.propTypes={},k.defaultProps={as:"th"};var P=k;function R(e){var t=e.active,n=e.cellAs,r=e.cells,a=e.children,s=e.className,h=e.disabled,v=e.error,m=e.negative,g=e.positive,b=e.textAlign,w=e.verticalAlign,x=e.warning,j=(0,c.Z)((0,u.lG)(t,"active"),(0,u.lG)(h,"disabled"),(0,u.lG)(v,"error"),(0,u.lG)(m,"negative"),(0,u.lG)(g,"positive"),(0,u.lG)(x,"warning"),(0,u.X4)(b),(0,u.Ok)(w),s),Z=(0,d.Z)(R,e),k=(0,p.Z)(R,e);return f.kK(a)?o.createElement(k,(0,i.Z)({},Z,{className:j}),(0,l.Z)(r,(function(e){return y.create(e,{defaultProps:{as:n}})}))):o.createElement(k,(0,i.Z)({},Z,{className:j}),a)}R.handledProps=["active","as","cellAs","cells","children","className","disabled","error","negative","positive","textAlign","verticalAlign","warning"],R.defaultProps={as:"tr",cellAs:"td"},R.propTypes={},R.create=(0,m.u5)(R,(function(e){return{cells:e}}));var C=R;function A(e){var t=e.attached,n=e.basic,r=e.celled,a=e.children,s=e.className,h=e.collapsing,m=e.color,g=e.columns,b=e.compact,y=e.definition,w=e.fixed,j=e.footerRow,k=e.headerRow,P=e.headerRows,R=e.inverted,q=e.padded,G=e.renderBodyRow,N=e.selectable,O=e.singleLine,_=e.size,z=e.sortable,T=e.stackable,E=e.striped,M=e.structured,F=e.tableData,S=e.textAlign,B=e.unstackable,H=e.verticalAlign,L=(0,c.Z)("ui",m,_,(0,u.lG)(r,"celled"),(0,u.lG)(h,"collapsing"),(0,u.lG)(y,"definition"),(0,u.lG)(w,"fixed"),(0,u.lG)(R,"inverted"),(0,u.lG)(N,"selectable"),(0,u.lG)(O,"single line"),(0,u.lG)(z,"sortable"),(0,u.lG)(T,"stackable"),(0,u.lG)(E,"striped"),(0,u.lG)(M,"structured"),(0,u.lG)(B,"unstackable"),(0,u.sU)(t,"attached"),(0,u.sU)(n,"basic"),(0,u.sU)(b,"compact"),(0,u.sU)(q,"padded"),(0,u.X4)(S),(0,u.Ok)(H),(0,u.H0)(g,"column"),"table",s),I=(0,d.Z)(A,e),D=(0,p.Z)(A,e);if(!f.kK(a))return o.createElement(D,(0,i.Z)({},I,{className:L}),a);var X={defaultProps:{cellAs:"th"}},K=(k||P)&&o.createElement(x,null,C.create(k,X),(0,l.Z)(P,(function(e){return C.create(e,X)})));return o.createElement(D,(0,i.Z)({},I,{className:L}),K,o.createElement(v,null,G&&(0,l.Z)(F,(function(e,t){return C.create(G(e,t))}))),j&&o.createElement(Z,null,C.create(j)))}A.handledProps=["as","attached","basic","celled","children","className","collapsing","color","columns","compact","definition","fixed","footerRow","headerRow","headerRows","inverted","padded","renderBodyRow","selectable","singleLine","size","sortable","stackable","striped","structured","tableData","textAlign","unstackable","verticalAlign"],A.defaultProps={as:"table"},A.propTypes={},A.Body=v,A.Cell=y,A.Footer=Z,A.Header=x,A.HeaderCell=P,A.Row=C;var q=A,G=n(80967),N=n(50262),O=n(83165),_=n(67156);function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t,n,r,a,s,o){try{var i=e[s](o),l=i.value}catch(c){return void n(c)}i.done?t(l):Promise.resolve(l).then(r,a)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){T(s,r,a,o,i,"next",e)}function i(e){T(s,r,a,o,i,"throw",e)}o(void 0)}))}}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}function H(e,t){return!t||"object"!==I(t)&&"function"!==typeof t?z(e):t}function L(e,t){return L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},L(e,t)}var I=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var a=B(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return H(this,n)}}var X=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(i,e);var t,n,r,o=D(i);function i(){var e;M(this,i),S(z(e=o.apply(this,arguments)),"state",{value:"",errorMessage:"",loadingApproval:!1,loadingFinalization:!1,showMessage:!1,messageContent:""});var t=z(e);S(z(e),"onApprove",E(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.initializeLoading(!1),e.prev=1,n=(0,O.Z)(t.props.address),e.next=5,_.Z.eth.getAccounts();case 5:return r=e.sent,e.next=8,n.methods.approveRequest(t.props.id).send({from:r[0]});case 8:t.setState({showMessage:!0,messageHeader:"Transaction was successful.",messageContent:"You have successfully approved this request."}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.setState({errorMessage:e.t0.message,showMessage:!1,loadingFinalization:!1,loadingApproval:!1});case 14:t.setState({loadingFinalization:!1,loadingApproval:!1,value:""}),N.Router.pushRoute("/campaigns/".concat(t.props.address,"/requests"));case 16:case"end":return e.stop()}}),e,null,[[1,11]])}))));var n=z(e);return S(z(e),"onFinalize",E(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.initializeLoading(!0),e.prev=1,t=(0,O.Z)(n.props.address),e.next=5,_.Z.eth.getAccounts();case 5:return r=e.sent,e.next=8,t.methods.finalizeRequest(n.props.id).send({from:r[0]});case 8:n.setState({showMessage:!0,messageHeader:"Transaction was successful.",messageContent:"This request has now been finalized."}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.setState({errorMessage:e.t0.message,showMessage:!1,loadingFinalization:!1,loadingApproval:!1});case 14:n.setState({loadingFinalization:!1,loadingApproval:!1,value:""}),N.Router.pushRoute("/campaigns/".concat(n.props.address,"/requests"));case 16:case"end":return e.stop()}}),e,null,[[1,11]])})))),S(z(e),"initializeLoading",(function(t){e.setState({loadingFinalization:t,loadingApproval:!t,errorMessage:"",showMessage:!0,messageContent:"Please wait... Your transaction is in progress and could take up to 30 seconds to process once initiated."})})),e}return t=i,(n=[{key:"render",value:function(){var e=q.Row,t=q.Cell,n=this.props,r=n.id,a=n.request,o=n.contributorCount,i=a.approvalCount>o/2;return(0,s.jsxs)(e,{disabled:a.complete,error:!!this.state.errorMessage,positive:!!this.state.showMessage,children:[(0,s.jsx)(t,{children:r}),(0,s.jsx)(t,{children:a.description}),(0,s.jsxs)(t,{children:[_.Z.utils.fromWei(a.value,"ether")," ETH"]}),(0,s.jsx)(t,{children:a.recipient}),(0,s.jsxs)(t,{positive:i,children:[a.approvalCount," / ",o]}),a.complete?(0,s.jsx)(t,{}):(0,s.jsx)(t,{children:(0,s.jsx)(G.Z,{color:"blue",basic:!0,loading:this.state.loadingApproval,onClick:this.onApprove,children:"Approve"})}),a.complete?(0,s.jsx)(t,{children:(0,s.jsx)(G.Z,{disabled:!0,color:"purple",basic:!0,onClick:this.onFinalize,children:"Finalized"})}):i?(0,s.jsx)(t,{children:(0,s.jsx)(G.Z,{color:"purple",basic:!0,loading:this.state.loadingFinalization,onClick:this.onFinalize,children:"Finalize"})}):(0,s.jsx)(t,{children:(0,s.jsx)(G.Z,{disabled:!0,color:"purple",basic:!0,onClick:this.onFinalize,children:"Finalize"})}),(0,s.jsx)(t,{children:this.state.errorMessage?this.state.errorMessage:this.state.showMessage?this.state.messageContent:a.complete?"This request has already been approved and finalized":i?"This request has already been approved and can now be finalized by the manager.":"This request does not have more than 50% approval and cannot be finalized until it does so."})]})}}])&&F(t.prototype,n),r&&F(t,r),i}(o.Component),K=X,U=n(5172);function W(e,t,n,r,a,s,o){try{var i=e[s](o),l=i.value}catch(c){return void n(c)}i.done?t(l):Promise.resolve(l).then(r,a)}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}function V(e,t){return!t||"object"!==ee(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}var ee=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q(e);if(t){var a=Q(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return V(this,n)}}var ne=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(i,e);var t,n,r,o=te(i);function i(){return Y(this,i),o.apply(this,arguments)}return t=i,r=[{key:"getInitialProps",value:function(e){return(t=a().mark((function t(){var n,r,s,o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query.address,t.prev=5,r=(0,O.Z)(n),t.next=9,r.methods.getRequestsCount().call();case 9:return s=t.sent,t.next=12,r.methods.approversCount().call();case 12:return o=t.sent,t.next=15,Promise.all(Array(parseInt(s)).fill().map((function(e,t){return r.methods.requests(t).call()})));case 15:i=t.sent,t.next=21;break;case 18:return t.prev=18,t.t0=t.catch(5),t.abrupt("return",{error:!0});case 21:return t.abrupt("return",{address:n,requests:i,requestCount:s,contributorCount:o,campaign:r});case 22:case"end":return t.stop()}}),t,null,[[5,18]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var s=t.apply(e,n);function o(e){W(s,r,a,o,i,"next",e)}function i(e){W(s,r,a,o,i,"throw",e)}o(void 0)}))})();var t}}],(n=[{key:"renderTableRows",value:function(){var e=this;return this.props.requests.map((function(t,n){return(0,s.jsx)(K,{id:n,request:t,address:e.props.address,contributorCount:e.props.contributorCount},n)}))}},{key:"render",value:function(){var e=q.Header,t=q.Row,n=q.HeaderCell,r=q.Body;return this.props.error?(0,s.jsx)(U.Z,{}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Campaign Requests"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Requests can be finalized here by the manager only. The option will be available once more than 50% of contributors have approved the request. If you attempt to finalize a request and are not a manager, it will get rejected and you will lose your gas."}),(0,s.jsx)("li",{children:"If you have already contributed to this campaign, you can approve requests here."}),(0,s.jsxs)("li",{children:["This campaign has a total of ",this.props.requestCount," requests."]})]}),(0,s.jsxs)(q,{celled:!0,children:[(0,s.jsx)(e,{children:(0,s.jsxs)(t,{children:[(0,s.jsx)(n,{children:"ID"}),(0,s.jsx)(n,{children:"Description"}),(0,s.jsx)(n,{children:"Amount"}),(0,s.jsx)(n,{children:"Recipient"}),(0,s.jsx)(n,{children:"Approval Count"}),(0,s.jsx)(n,{children:"Approve"}),(0,s.jsx)(n,{children:"Finalize"}),(0,s.jsx)(n,{children:"Comment"})]})}),(0,s.jsx)(r,{children:this.renderTableRows()})]}),(0,s.jsx)("div",{className:"row justify-content-md-center",children:0==this.props.requestCount&&"This campaign has no requests."}),(0,s.jsx)("hr",{}),(0,s.jsx)("p",{children:"If you are the campaign manager, you can create a new spending request here."}),(0,s.jsx)(N.Link,{route:"/campaigns/".concat(this.props.address,"/requests/new"),children:(0,s.jsx)("a",{children:(0,s.jsx)(G.Z,{primary:!0,children:"Create Request"})})}),(0,s.jsx)("hr",{})]})}}])&&J(t.prototype,n),r&&J(t,r),i}(o.Component),re=ne}},function(e){e.O(0,[482,714,389,762,774,888,179],(function(){return t=19553,e(e.s=t);var t}));var t=e.O();_N_E=t}]);